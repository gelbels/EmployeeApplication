<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNFinished Business Job Application</title>
    <link rel="stylesheet" href="styles2.css">
</head>

<main class="container">
    <div class="header">
        <h1>Unfinished Business</h1>
        <h2>Employment Application</h2>
    </div>

    <div class="input-text">
        <label for="name">First Name</label>
        <input type="text" id="name" name="name" data-placeholder="First Name" required>
    </div>

    <div class="input-wrapper">
        <input type="text" id="middle-name" name="middle-name" placeholder="Middle Name" pattern="[A-Za-z\s]+" required>
        <label for="middle-name">Middle</label>
    </div>

    <script src="/niceinput.js"></script>

    <script src="https://unpkg.com/htmx.org@1.9.9"
        integrity="sha384-QFjmbokDn2DjBjq+fM+8LUIVrAgqcNW2s0PjAxHETgRn9l4fvX31ZxDxvwQnyMOX"
        crossorigin="anonymous"></script>
    <script src="/js/iframeResizer.min.js"></script>

    <!-- <iframe id="iframe1" src="/page1.html" name="pages" frameborder="0"></iframe>
    <iframe id="iframe2" src="/page1.html" name="pages" frameborder="0"></iframe> -->

    <form id="main-form" action="">

    </form>

    <div class="footer center-group">
        <button id="button-previous" class="button left" onclick="movePage(-1)">
            <span>Previous</span>
        </button>
        <button id="button-next" class="button right" onclick="movePage(1)">
            <span>Next</span>
        </button>
    </div>

    <script>
        const pages = [
            "/page1.html",
            "/page2.html",
            "/page3-4.html",
            "/page7.html",
            "/page8.html",
            "/finished.html"
        ]

        var iframes = [];

        var currentPage = 0;

        const init = () => {
            const form = document.getElementById("main-form")

            const div = document.createElement("div")
            div.className = "page-container"
            div.style.width = "100%"
            div.style.height = "100%"
            form.appendChild(div)

            var i = 0;
            pages.forEach((page) => {
                const iframe = document.createElement("iframe")
                iframe.src = page
                iframe.id = "iframe-page" + i++; // id's must be unique???
                iframe.className = "page"
                iframe.frameBorder = "0"
                // iframe.style.position = "absolute"
                // iframe.style.transform = "translateX(" + -100 * (i - pageIndex) + "%)"
                iframe.style.display = "block";
                iframe.style.visibility = "hidden";

                // iframes[i] = iFrameResize({ log: false }, "#iframe" + i)[0]

                // iframe.addEventListener("animationstart", (event) => {
                //     console.log("LSDAM;kasd")
                //     event.element.style.display = "block"
                // })
                // iframe.addEventListener("animationend", (event) => {
                //     event.element.style.display = "none"
                //     // if (event.animationName == "slide-out-right" || event.animationName == "slide-out-left") {
                //     //     iframe.style.display = "none"
                //     // }
                // })

                div.appendChild(iframe)
                // form.appendChild(iframe)
            })

            iframes = iFrameResize({ log: false }, ".page-container iframe");

            showPage(0, 1);
        }

        const movePage = (direction) => {
            const currentIframe = iframes[currentPage]
            const nextPage = Math.min(pages.length - 1, Math.max(0, currentPage + direction))
            const nextIframe = iframes[nextPage]

            iframes.forEach((iframe) => {
                iframe.iFrameResizer.resize()
            })

            hidePage(currentPage, direction);
            showPage(nextPage, direction);

            currentPage = nextPage;
        }

        const showPage = (index, direction) => {
            const iframe = iframes[index]
            iframe.style.visibility = "visible"
            iframe.iFrameResizer.resize()


            // iframe.style.display = "block"
            // iframe.style.animationName = "slide-in-right"
            // iframe.style.animationDuration = "0.5s"
            // iframe.style.animationFillMode = "forwards"
        }

        const hidePage = (index, direction) => {
            const iframe = iframes[index]

            // iframe.style.display = "none"
            iframe.style.visibility = "hidden"

            // iframe.style.animationName = "slide-out-right"
            // iframe.style.animationDuration = "0.5s"
            // iframe.style.animationFillMode = "forwards"
        }

        init();
    </script>

    <!-- <script>
        const pages = [
            "/page1.html",
            "/page2.html",
            "/page3-4.html",
            "/page7.html",
            "/page8.html",
            "/finished.html"
        ]

        var iframes = []

        var pageIndex = 0;

        const init = () => {
            const div = document.createElement("div")
            div.className = "page-container"
            div.style.width = "100%"
            div.style.height = "100%"
            for (let i = 0; i < pages.length; i++) {

                const form = document.getElementById("main-form")
                form.appendChild(div)

                const iframe = document.createElement("iframe")
                iframe.src = pages[i]
                iframe.id = "iframe" + i
                iframe.className = "page"
                iframe.frameBorder = "0"
                // iframe.style.position = "absolute"
                // iframe.style.transform = "translateX(" + -100 * (i - pageIndex) + "%)"
                // iframe.style.display = "none"

                div.appendChild(iframe)
                // form.appendChild(iframe)

                iframes[i] = iFrameResize({ log: false }, "#iframe" + i)[0]

                iframe.addEventListener("animationstart", (event) => {
                    console.log("LSDAM;kasd")
                    event.element.style.display = "block"
                })
                iframe.addEventListener("animationend", (event) => {
                    event.element.style.display = "none"
                    // if (event.animationName == "slide-out-right" || event.animationName == "slide-out-left") {
                    //     iframe.style.display = "none"
                    // }
                })
            }
        }


        const elementFade = (element, fade) => {
            if (fade) {
                element.classList.remove("fade-in")
                element.classList.add("fade-out")
            } else {
                element.classList.remove("fade-out")
                element.classList.add("fade-in")
            }
        }

        const elementSlideIn = (element, direction) => {
            if (direction >= 0) {
                element.classList.remove("slide-out-right")
                element.classList.remove("slide-out-left")
                element.classList.add("slide-in-right")
            } else {
                element.classList.remove("slide-out-left")
                element.classList.remove("slide-out-right")
                element.classList.add("slide-in-left")
            }
        }

        const elementSlideOut = (element, direction) => {
            if (direction >= 0) {
                element.classList.remove("slide-in-left")
                element.classList.remove("slide-in-right")
                element.classList.add("slide-out-right")
            } else {
                element.classList.remove("slide-in-left")
                element.classList.remove("slide-in-right")
                element.classList.add("slide-out-left")
            }
        }

        const updatePage = (index, direction) => {
            const iframe = iframes[index]
            iframe.iFrameResizer.resize()

            // for (let i = 0; i < pages.length; i++) {
            //     const iframe = iframes[i]
            //     iframe.style.transform = "translateX(" + 100 * (i - index) + "%)"
            // }

            if (index >= (pages.length - 1)) {
                document.getElementById("button-previous").style.display = "none";
                document.getElementById("button-next").style.display = "none";
            } else {
                if (index == 0) {
                    document.getElementById("button-previous").style.display = "none";
                } else {
                    document.getElementById("button-previous").style.display = "block";
                }

                if (index == (pages.length - 2)) {
                    document.querySelector("#button-next span").textContent = "Submit";
                } else {
                    document.querySelector("#button-next span").textContent = "Next";
                }
            }
        }

        const movePage = (direction) => {
            // console.log(validateForm())

            const lastIndex = pageIndex

            if (direction === 1) {
                // if (!validateForm()) return false;
                pageIndex = Math.min(pages.length - 1, pageIndex + 1)
            } else {
                pageIndex = Math.max(0, pageIndex - 1)
            }

            {
                const iframeLast = iframes[lastIndex]
                // elementSlideOut(iframeLast, -direction)
                elementFade(iframeLast, true)
            }

            console.log(lastIndex, pageIndex)

            {
                updatePage(pageIndex, direction)

                const iframeNext = iframes[pageIndex]
                // elementSlideIn(iframeNext, direction)
                elementFade(iframeNext, false)
            }
        }

        const validateForm = () => {
            const currentIframe = iframes[pageIndex]
            const currentForm = currentIframe.contentWindow.document.querySelectorAll("form")[0]

            var valid = true;

            // console.log(currentForm.querySelectorAll("input"))

            currentForm.querySelectorAll("input").forEach((input) => {
                if (input.validity.valid) {
                    input.classList.remove("invalid")
                } else {
                    input.classList.add("invalid")
                    valid = false
                }
            })
            currentForm.querySelectorAll("textarea").forEach((textarea) => {
                if (textarea.validity.valid) {
                    textarea.classList.remove("invalid")
                } else {
                    textarea.classList.add("invalid")
                    valid = false
                }
            })
            currentForm.querySelectorAll("select").forEach((select) => {
                if (select.validity.valid) {
                    select.classList.remove("invalid")
                } else {
                    select.classList.add("invalid")
                    valid = false
                }
            })
            return valid
        }

        init();
    </script> -->

    <!-- <div class="footer center">
        <a class="button" href="page2.html">
            Next
        </a>
    </div> -->
</main>

</html>