<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNFinished Business Job Application</title>
    <link rel="stylesheet" href="styles2.css">
</head>

<body class="container">
    <div class="header">
        <h1>Unfinished Business</h1>
        <h2>Employment Application</h2>
    </div>

    <script src="/js/iframeResizer.min.js"></script>

    <!-- <iframe id="iframe1" src="/page1.html" name="pages" frameborder="0"></iframe>
    <iframe id="iframe2" src="/page1.html" name="pages" frameborder="0"></iframe> -->

    <form id="main-form" action="">

    </form>

    <div class="footer center-group">
        <button id="button-previous" class="button left" onclick="movePage(-1)">
            <span>Previous</span>
        </button>
        <button id="button-next" class="button right" onclick="movePage(1)">
            <span>Next</span>
        </button>
    </div>

    <script>
        const pages = [
            "/page1.html",
            "/page2.html",
            "/page3-4.html",
            "/page7.html",
            "/page8.html",
            "/finished.html"
        ]

        var iframes = []

        var pageIndex = 2;

        for (let i = 0; i < pages.length; i++) {
            const div = document.createElement("div")
            div.className = "page-container"
            div.style.width = "100%"
            div.style.height = "100%"

            const form = document.getElementById("main-form")
            form.appendChild(div)

            const iframe = document.createElement("iframe")
            iframe.src = pages[i]
            iframe.id = "iframe" + i
            iframe.className = "page"
            iframe.frameBorder = "0"
            // iframe.style.position = "absolute"
            // iframe.style.transform = "translateX(" + -100 * (i - pageIndex) + "%)"
            iframe.style.display = "none"

            div.appendChild(iframe)

            iframes[i] = iFrameResize({ log: false }, "#iframe" + i)[0]

        }

        const showPage = (index) => {
            const iframe = iframes[index]
            iframe.iFrameResizer.resize()

            // for (let i = 0; i < pages.length; i++) {
            //     const iframe = iframes[i]
            //     iframe.style.transform = "translateX(" + -100 * (i - index) + "%)"
            // }

            iframes.forEach((iframe) => {
                iframe.style.display = "none"
            })

            iframe.style.display = "inline"

            if (index >= (pages.length - 1)) {
                document.getElementById("button-previous").style.display = "none";
                document.getElementById("button-next").style.display = "none";
            } else {
                if (index == 0) {
                    document.getElementById("button-previous").style.display = "none";
                } else {
                    document.getElementById("button-previous").style.display = "block";
                }

                if (index == (pages.length - 2)) {
                    document.querySelector("#button-next span").textContent = "Submit";
                } else {
                    document.querySelector("#button-next span").textContent = "Next";
                }
            }
        }

        const movePage = (direction) => {
            // console.log(validateForm())
            if (direction === 1) {
                // if (!validateForm()) return false;
                pageIndex = Math.min(pages.length - 1, pageIndex + 1)
            } else {
                pageIndex = Math.max(0, pageIndex - 1)
            }

            showPage(pageIndex)
        }

        const validateForm = () => {
            const currentIframe = iframes[pageIndex]
            const currentForm = currentIframe.contentWindow.document.querySelectorAll("form")[0]

            var valid = true;

            // console.log(currentForm.querySelectorAll("input"))

            currentForm.querySelectorAll("input").forEach((input) => {
                if (input.validity.valid) {
                    input.classList.remove("invalid")
                } else {
                    input.classList.add("invalid")
                    valid = false
                }
            })
            currentForm.querySelectorAll("textarea").forEach((textarea) => {
                if (textarea.validity.valid) {
                    textarea.classList.remove("invalid")
                } else {
                    textarea.classList.add("invalid")
                    valid = false
                }
            })
            currentForm.querySelectorAll("select").forEach((select) => {
                if (select.validity.valid) {
                    select.classList.remove("invalid")
                } else {
                    select.classList.add("invalid")
                    valid = false
                }
            })
            return valid
        }


        showPage(pageIndex);
    </script>

    <!-- <div class="footer center">
        <a class="button" href="page2.html">
            Next
        </a>
    </div> -->
</body>

</html>